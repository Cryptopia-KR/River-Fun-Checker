/* River Fun Checker v1.0.0 - Licensed Code */
async function t(){var e=h.value.trim();if(e){r(),o(),s();try{n(await d.getUserAccount(e)),a()}catch(e){a(),c("User not found. Please check the username."),console.error("Search error:",e)}}else c("Please enter a username.")}function n(e){var t,s=document.getElementById("userAvatar");if(s.style.display="block",e.twitterUsername){let n="https://unavatar.io/twitter/"+e.twitterUsername,r=`https://app.river.inc/_next/image?url=${encodeURIComponent(n)}&w=128&q=75&dpl=dpl_Gm162MJm5U3qyT2cVX1TQXA52kRN`,a=`https://app.river.inc/_next/image?url=${encodeURIComponent(n)}&w=64&q=75&dpl=dpl_Gm162MJm5U3qyT2cVX1TQXA52kRN`,c=(t=`https://app.river.inc/_next/image?url=${encodeURIComponent(n)}&w=32&q=75&dpl=dpl_Gm162MJm5U3qyT2cVX1TQXA52kRN`,!1),o=!1,i=!1;s.onload=function(){var e=this.naturalWidth,t=this.naturalHeight;c||e<64||t<64||e!==t?c||64<=e&&64<=t&&e===t?c&&!o&&e!==t?(o=!0,this.src=r):!o||i||10<e&&10<t&&e===t||(i=!0,this.src=n):(c=!0,this.src=a):c=!0},s.onerror=function(){c?o?i||(i=!0,this.src=n):(o=!0,this.src=r):(c=!0,this.src=a)},s.src=t}else s.src="",s.style.display="none";document.getElementById("userName").textContent=e.twitterName||"",document.getElementById("userUsername").textContent="@"+e.twitterUsername,document.getElementById("userTier").textContent="Tier "+e.tier,document.getElementById("scoreRank").textContent="#"+(e.scoreRank?.toLocaleString()||"N/A"),document.getElementById("rewardRank").textContent="#"+(e.rewardRank?.toLocaleString()||"N/A"),document.getElementById("score").textContent=e.score?.toFixed(2)||"0",document.getElementById("dailyEarned").textContent=Math.floor(e.totalRewardDiff||0).toLocaleString(),document.getElementById("dailyReward").textContent=Math.floor(e.dailyReward||0).toLocaleString(),document.getElementById("totalReward").textContent=Math.floor(e.totalReward||0).toLocaleString(),document.getElementById("airdropAmount").textContent=Math.floor(e.airdropAmount||0).toLocaleString(),document.getElementById("mindShare").textContent=e.mindShare?.toFixed(3)||"0",i()}function r(){m.classList.remove("hidden"),e.disabled=!0}function a(){m.classList.add("hidden"),e.disabled=!1}function c(e){l.textContent=e,l.classList.remove("hidden")}function o(){l.classList.add("hidden")}function i(){p.classList.remove("hidden")}function s(){p.classList.add("hidden")}let u="https://api-v2.satoshiprotocol.org";class d{static async getUserAccount(e){try{var t=(new Date).getTime(),n=await fetch(u+`/twitter/account?twitterUsername=${e}&_t=`+t,{cache:"no-cache",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(n.ok)return(await n.json()).data;throw Error("HTTP error! status: "+n.status)}catch(e){throw console.error("Error fetching user account:",e),e}}static async getUserRanking(e=1,t=100){try{var n=await fetch(u+`/twitter/account-list?itemsPerPage=${t}&currentPage=${e}&sortBy=scoreRank&direction=asc`);if(n.ok)return await n.json();throw Error("HTTP error! status: "+n.status)}catch(e){throw console.error("Error fetching ranking:",e),e}}}let h=document.getElementById("usernameInput"),e=document.getElementById("searchBtn"),m=document.getElementById("loading"),l=document.getElementById("error"),p=document.getElementById("userInfo");e.addEventListener("click",t),h.addEventListener("keypress",e=>{"Enter"===e.key&&t()}),document.addEventListener("DOMContentLoaded",()=>{chrome.storage.local.get(["lastUsername"],e=>{e.lastUsername&&(h.value=e.lastUsername,t())})}),h.addEventListener("input",()=>{chrome.storage.local.set({lastUsername:h.value})});